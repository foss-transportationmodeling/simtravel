<ProjectConfig>
  <Project name="mag_zone" location="/workspace/projects/mag_zone/" seed="10" subsample="40000"/>
  <DTAConnection value="True"/>
  <DBConfig dbprotocol="postgres" dbhost="localhost" dbname="mag_zone" dbusername="postgres" dbpassword="1234"/>
  <TravelSkims reference_tablename="travel_skims" indb="True">
    <Period tablename="travel_skims_offpeak" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="0" intervalEnd="119"/>
    <Period tablename="travel_skims_offpeak" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="120" intervalEnd="299"/>
    <Period tablename="travel_skims_offpeak" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="300" intervalEnd="659"/>
    <Period tablename="travel_skims_offpeak" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="660" intervalEnd="899"/>
    <Period tablename="travel_skims_offpeak" origin_var="origin" destination_var="destination" skim_var="tt" intervalStart="900" intervalEnd="1439"/>
  </TravelSkims>

  <Locations reference_tablename="locations" tablename="locations" location_var="locationid" indb="True">
    <LocationVariable var="retail_employment"/>
    <LocationVariable var="public_employment"/>
    <LocationVariable var="residential_population"/>
    <LocationVariable var="total_area"/>
    <LocationVariable var="multi_family_dwelling"/>
    <LocationVariable var="single_family_dwelling"/>
    <LocationVariable var="institutional_population"/>
  </Locations>


  <ModelConfig>

    <Component name="ExtractTravelEpisodes" read_from_table="schedule_final_r" write_to_table="trips_r" key="houseid,personid" skip="False" completed="True">
      <DBTables>
    	<Table table="persons" key="houseid,personid" order="1"/>
    	<Table table="trips_r" key="houseid,personid"/>
    	<Table table="child_dependency_r" key="houseid,personid"/>
    	<Table table="schedule_final_r" key="houseid,personid"/>
      </DBTables>

      <SpatialConstraints table="travel_skims" skim_var="tt" as_var="tt_to" origin_var="origin" destination_var="destination">
	<Start table="schedule_final_r" location_var="locationid" time_var="endtime"/>
	<End table="schedule_final_r" location_var="locationid" time_var="starttime"/>
      </SpatialConstraints>

      <Model name="DummyLocationId" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="locationid"/>
	<Variance value="0"/>
        <Variable table="runtime" var="locationid" coeff="1"/>
      </Model>

      <Model name="VehicleID" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="vehid"/>
	<Variance value="0"/>
        <Variable table="persons" var="one" coeff="1"/>
      </Model>
      <Model name="ModeChoice" formulation="Probability Distribution" seed="1">
        <DependentVariable var="tripmode"/>

        <Alternative id="SOV" value="1">
          <Variable table="persons" var="one" coeff="0.0"/>
        </Alternative>
        <Alternative id="HOVD" value="2">
          <Variable table="persons" var="one" coeff="0.0"/>
        </Alternative>
        <Alternative id="HOVP" value="3">
          <Variable table="persons" var="one" coeff="1.0"/>
        </Alternative>
      </Model>
      <Model name="FromZone" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="fromzone"/>
	<Variance value="0"/>
        <Variable table="runtime" var="st_locationid" coeff="1"/>
      </Model>
      <Model name="ToZone" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tozone"/>
	<Variance value="0"/>
        <Variable table="runtime" var="en_locationid" coeff="1"/>
      </Model>
      <Model name="starttime" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="starttime"/>
	<Variance value="0"/>
        <Variable table="runtime" var="st_endtime" coeff="1"/>
      </Model>
      <Model name="endtime" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="endtime"/>
	<Variance value="0"/>
        <Variable table="runtime" var="en_starttime" coeff="1"/>
      </Model>
      <Model name="trippurpose" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="trippurpose"/>
	<Variance value="0"/>
        <Variable table="runtime" var="en_activitytype" coeff="1"/>
      </Model>





      <Model name="validtrip" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tripind"/>
	<Filter table="runtime" var="st_locationid" condition="not equals" valuetable="runtime" valuevar="en_locationid"/>
	<Variance value="0"/>
        <Variable table="persons" var="one" coeff="1"/>
      </Model>

      <Model name="validtrip" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tripind"/>
        <FilterSet type="and"/>
	<Filter table="runtime" var="st_locationid" condition="equals" valuetable="runtime" valuevar="en_locationid"/>
	<Filter table="runtime" var="en_activitytype" condition="greater than equals" value="200"/>
	<Filter table="runtime" var="duration" condition="greater than equals" value="2"/>
	<Variance value="0"/>
        <Variable table="persons" var="one" coeff="1"/>
      </Model>



      <Model name="dummyforadult" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="adulttrips"/>
	<Filter table="runtime" var="tripind" condition="equals" value="1"/>
	<Filter table="child_dependency_r" var="dependency" condition="equals" value="0"/>
	<Variance value="0"/>
        <Variable table="persons" var="one" coeff="1"/>
      </Model>

    </Component>


    <Component name="ExtractBackgroundTravelEpisodes" read_from_table="background_trips" write_to_table="trips_r" key="houseid,personid" skip="False" completed="True">
      <DBTables>
    	<Table table="trips_r" key="houseid,personid"/>
   	<Table table="background_trips" key="houseid,personid" order="1"/>
      </DBTables>

      <AnalysisIntervalFilter table="background_trips" var="start_min"/>


      <Model name="VehicleID" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="vehid"/>
	<Variance value="0"/>
        <Variable table="background_trips" var="vehid" coeff="1"/>
      </Model>

      <Model name="ModeChoice" formulation="Regression" type="Linear" seed="1">
        <DependentVariable var="tripmode"/>
	<Variance value="0"/>
        <Variable table="background_trips" var="mode" coeff="1"/>
      </Model>

      <Model name="FromZone" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="fromzone"/>
	<Variance value="0"/>
        <Variable table="background_trips" var="origin_taz" coeff="1"/>
      </Model>

      <Model name="ToZone" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tozone"/>
	<Variance value="0"/>
        <Variable table="background_trips" var="destination_taz" coeff="1"/>
      </Model>

      <Model name="trippurpose" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="trippurpose"/>
	<Variance value="0"/>
        <Variable table="background_trips" var="purpose" coeff="1"/>
      </Model>

      <Model name="starttime" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="starttime"/>
	<Variance value="0"/>
        <Variable table="background_trips" var="start_min" coeff="1"/>
      </Model>

      <Model name="endtime" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="endtime"/>
        <FilterSet type="and"/>
	<Filter table="background_trips" var="origin_region" condition="not equals" value="1"/>
	<Filter table="background_trips" var="destination_region" condition="not equals" value="1"/>
	<Filter table="background_trips" var="origin_taz" condition="less than" value="3000"/>
	<Filter table="background_trips" var="destination_taz" condition="less than" value="3000"/>

	<Variance value="0"/>
        <Variable table="background_trips" var="arrive_min" coeff="1"/>
      </Model>

    </Component>

    <Component name="ExtractAllTravelEpisodes" read_from_table="trips_r" write_to_table="trips_final_r" key="houseid,personid" skip="False" completed="True">
      <DBTables>
    	<Table table="persons" key="houseid,personid"/>
    	<Table table="trips_r" key="houseid,personid" order="1"/>
    	<Table table="trips_final_r" key="houseid,personid"/>
      </DBTables>

      <AnalysisIntervalFilter table="trips_r" var="starttime"/>

      <Model name="TripID" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tripid"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="tripid" coeff="1"/>
      </Model>


      <Model name="VehicleID" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="vehid"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="vehid" coeff="1"/>
      </Model>

      <Model name="ModeChoice" formulation="Regression" type="Linear" seed="1">
        <DependentVariable var="tripmode"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="tripmode" coeff="1"/>
      </Model>

      <Model name="FromZone" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="fromzone"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="fromzone" coeff="1"/>
      </Model>

      <Model name="ToZone" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="tozone"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="tozone" coeff="1"/>
      </Model>

      <Model name="Duration" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="duration"/>
	<Variance value="0"/>
        <Variable table="runtime" var="endtime" coeff="1"/>
        <Variable table="runtime" var="starttime" coeff="-1"/>
      </Model>


      <Model name="trippurpose" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="trippurpose"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="trippurpose" coeff="1"/>
      </Model>

      <Model name="starttime" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="starttime"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="starttime" coeff="1"/>
      </Model>

      <Model name="endtime" formulation="Regression" type="Linear" seed="1">
	<DependentVariable var="endtime"/>
	<Variance value="0"/>
        <Variable table="trips_r" var="endtime" coeff="1"/>
      </Model>

    </Component>




  </ModelConfig>
</ProjectConfig>
